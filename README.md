# Rabbit keypoint detection

## Сравнение нейронных сетей и фреймворков для нахождения ключевых точек на теле животных

| Нейронная сеть / фреймворк | Преимущества | Недостатки | Примечания |
|----------------------------|--------------|------------|------------|
| DeepLabCut                 | - Встроенная программа для разметки данных. <br><br> - Можно работать как через Python, таки через GUI. <br><br> - Относительно быстрое обучение модели на CPU при использовании MobileNet. | - Для настройки необходимо редактировать файлы проекта вручную. <br><br> - Отдельной документации по нейросети нет, документация разбросана в обучающих статьях по использованию нейросети. | - Нейронная сеть обучалась в течение ~1 часа (30000 эпох) на модели MobileNet на CPU. После обучения модель показала хороший результат, отмечая корректно точки на всех кадрах. Моделью была упущена одна точка, которая появлялась слишком редко в обучающей выборке. |
| SLEAP                      | - Удобный графический интерфейс для всех задач: от разметки данных до обучения и тестирования нейронной сети. <br><br> - Есть возможность импортировать разметку данных из DeepLabCut, AlphaTracker и DeepPoseKit. <br><br> - Весь проект хранится в файле специального формата без множества файлов и каталогов. <br><br> - Подробная документация по командам. | - Нет возможности получить готовое размеченное видео. Можно только просматривать его кадры и получить csv в разметкой. <br><br> - Более долгое обучение даже с использованием GPU в сравнении с DeepLabCut. <br><br> - Всё управление нейросетью происходит либо через GUI, либо через консольные команды, что не позволяет в привычном понимании написать код, который будет запускать обучение нейросети. <br><br> - Обучение на слабом GPU скорее всего невозможно. Нейросеть сразу завершает обучение из-за невозможности выделить достаточное количество графической памяти.<br><br> - Существует множество различных способов сделать одно и то же действие (CLI, GUI, Python), не все из которых достаточно подробно описаны в документации. | - После обучения нейросети уже обученную модель можно использовать в Python скрпитах. <br><br> - Нейронная сеть обучалась в течение ~2-3 часов (60 эпох) на GPU. После обучения модель показала плохой результат. Она не отмечала 3 точки, 2 из который присутствовали в обучающих данных в значительной степени.  |
| DeepPoseKit | - Вся настройка происходит в Python скриптах, за счёт чего можно гибко настроить параметры обучения и запуска нейросети. | - На данный момент нейросеть несовместима с Windows из-за конфликтов со сторонними библиотеками. Возможно, её можно запустить, но это очень затруднительно. <br><br> - Графический интерфейс не работал на Windows несмотря на исправление конфликтов со сторонними библиотеками | - На данный момент нейронная сеть не была опробована ввиду сложностей с запуском. |
| AlphaTracker | | | - На данный момент нейронная сеть не была опробована |

## Архитектура проекта
<p align="center">
    <img src="images/architecture%20-%20data%20preparation.png" alt="drawing" width="300"/>
</p>

<p align="center">
<img src="images/architecture%20-%20NN%20training.png" alt="drawing" width="450"/>
</p>

<p align="center">
<img src="images/architecture - inference.png" alt="drawing" width="400"/>
</p>